<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/html" xmlns="http://www.w3.org/1999/html">
<head>
	<!-- Mobile viewport optimization http://goo.gl/b9SaQ -->
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />	
	<meta name="HandheldFriendly" content="True" />
	<meta name="MobileOptimized" content="320" />
	<!-- put in to ensure that scripts run correctly for browsers on android devices -->
	<meta http-equiv="Content-Script-Type" content="text/javascript" />
	<!-- put in to ensure browser behaves correctly in Android devices -->
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
	
	<!-- Mobile IE allows us to activate ClearType technology for smoothing fonts for easy reading  -->
	<meta http-equiv="cleartype" content="on" />
	
	<!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame
	Remove this if you use the .htaccess -->
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	

    <link href="css/modern.css" rel="stylesheet">
    <link href="css/modern-responsive.css" rel="stylesheet">
    <link href="css/site.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="css/freeow.css"  />

    <script src="js/app/utility.js"></script>
    <script src="js/app/dashboard.js"></script>
    <script src="js/jquery-2.1.1.min.js"></script>
    <script src="js/jquery-ui.min.js"></script>
    <script src="js/jquery.ui.touch-punch.min.js"></script>
    <script src="js/jquery.freeow.min.js"></script>
    
    <title>ETM+</title>
</head>

<script>
	var home = new Dashboard();
 	var removedBtn = new Array();
	
	$(document).ready(
		function dashboard() {
			home.loadAllViewSets();
			var menudata = buildDashboard(home, true);
			$("#dashbuttons").html(menudata);

			$('div[name|="subtilebtn"]').click(function() {
				var elmt = $($(this).parent()).parent();
				var id = $(elmt).attr('id');
				id = id.substring(id.indexOf('-')+1, id.length);
 				removedBtn.push(home.arBtnset.splice(getIndex(home.arBtnset, parseInt(id)), 1));
				$(elmt).hide(500);
			});			
		}
	);
	
	function checkwidth(str) {
		var scr_width = $(window).width();
		if(scr_width < 360){}
	}

    $(function() {
        $( "#dashbuttons" ).sortable();
        $( "#dashbuttons" ).disableSelection();
    });
function getIndex(array, id){
	for(i in array){
		if(id == array[i].id)
			return i;
	}
	
	return -1;
}
function saveSettings(){
	// update deleted and change in position
	var strhtml = document.getElementById("dashbuttons").innerHTML;
	var newBtnSet = new Array();
	var tilebtn = new tile_btn()
	for(var cnt = 0, str = strhtml; newBtnSet.length < home.arBtnset.length; cnt++){
		
		var str = str.substring(str.indexOf('tilebtn-'), str.length);
		var id = str.substring(0, str.indexOf('"'));
		
		// got the id
		id = id.substring(id.indexOf('-')+1, id.length);
		var index = getIndex(home.arBtnset, parseInt(id));
		if(index != -1){
			tilebtn = home.arBtnset[index];
			newBtnSet.push(tilebtn);
		}
		
		var str = str.substring(str.indexOf('tilebtn-')+1, str.length);
	}
	
	
// 	tilebtn.setTile_btn(1, airportcode, airporttext, 
// 			terminal, localtime, flight, displaymode, btncolor);
	
	home.add_arBtnset(newBtnSet);
	showMessage("Dashboard Buttons settings are saved successfully.", "", "success_msg");
}

</script>

<body class="modern-ui">
<div class="page bg-color-white">
	<div id="navbar" class="navbar">
	    <div class="navbar-inner">
	        <div class="container-fluid">
		    <a class="pull-left" style="margin: 3px 5px 0px -10px;" href="../">
                        <img src="images/avatar.png" style="max-height: 34px;" />
                    </a>
	            <h1><a class="brand" href="index.html">ETM+</a></h1>
	            <div class="nav-collapse">
	                <ul class="nav pull-right">
	                    <li><a href="settings.html">
	                    	<img src="images/pull24.png" 
	                    	style="max-height: 20px; margin-right: 5px;" />Other Airports</a></li>
	                    <li><a href="https://auth.baplc.com/logout/countdown.html">
	                    	<img src="images/logout.png" 
	                    	style="max-height: 20px; margin-right: 5px;" />Logout</a></li>                            
	                </ul>
	            </div>
	        </div>
	    </div>
	</div>
	<div style="align:middle;">
	<div id="freeow" class="freeow freeow-center"></div>
	</div>
	
	<h3 class="fg-color-blueDark"> Arrange/Remove Dashboard Buttons</h3>
	<p class="fg-color-blue"><I>Drag and drop the button to change the position or press 
	<img src="images/remove.png" style="max-height: 15px;"/> to remove button.</I></p>
<!-- 	<div class="border-color-red" style="border:1px solid;border-radius:5px;height:50px;"> -->
	<hr>
	<button class="bg-color-blue fg-color-white" onclick='saveSettings();'><h4>Save Your Changes</h4></button>
	<button class="bg-color-red fg-color-white" 
	onclick="location.href='settings.html';"><h4>Cancel</h4></button>
<!-- 	</div> -->
	<hr>

	<!-- tiles -->
	<div class="clearfix">
		<div id="dashbuttons"></div>
	</div>
</div>
	
</body>

</html>
